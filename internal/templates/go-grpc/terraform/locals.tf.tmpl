locals {
  service_name    = "{{tosnakecase .Name}}"
  repo_name       = "{{.Name}}"
  deploy_env_name = module.workspace_context.workspace_deploy_env[terraform.workspace]
  subdomain       = module.workspace_context.env_subdomain[terraform.workspace]
  env_name        = module.workspace_context.env_name[terraform.workspace]
  app_count       = 3
  ecs_task_port   = 443

  dns_record = {
    "caring-prod": local.repo_name
    "caring-stg": "${local.repo_name}.${local.subdomain}"
    "caring-dev": "${local.repo_name}.${local.subdomain}"
  }

  secretsmanager_recovery_window = {
    "caring-dev"  = 0
    "caring-stg"  = 0
    "caring-prod" = 30
  }

{{if .UseReporting}}
  storage_aws_iam_user_arn = {
    "caring-dev": "",
    "caring-stg": "",
    "caring-prod": ""
  }

  storage_aws_external_id = {
    "caring-dev": "",
    "caring-stg": "",
    "caring-prod": ""
  }

  snowpipe_sqs_arn = {
    "caring-dev": "",
    "caring-stg": "",
    "caring-prod": ""
  }
{{end}}

  tags = {
    service_name = local.service_name,
    env          = terraform.workspace,
    terraform    = "true",
    repo_name    = local.repo_name
  }
}
